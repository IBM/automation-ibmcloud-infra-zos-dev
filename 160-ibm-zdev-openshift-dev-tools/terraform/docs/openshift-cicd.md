# OpenShift CICD module

Module to provision Tekton and ArgoCD into an OpenShift cluster together


## Software dependencies

The module depends on the following software components:

### Terraform version

- \>= v0.15

### Terraform providers


None

### Module dependencies


- cluster - interface github.com/cloud-native-toolkit/automation-modules#cluster
- olm - [github.com/cloud-native-toolkit/terraform-k8s-olm](https://github.com/cloud-native-toolkit/terraform-k8s-olm) (>= 1.2.2)
- gitops_namespace - [github.com/cloud-native-toolkit/terraform-k8s-namespace](https://github.com/cloud-native-toolkit/terraform-k8s-namespace) (>= 2.1.0)
- sealed_secret_namespace - [github.com/cloud-native-toolkit/terraform-k8s-namespace](https://github.com/cloud-native-toolkit/terraform-k8s-namespace) (>= 2.1.0)
- cert - [github.com/cloud-native-toolkit/terraform-util-sealed-secret-cert](https://github.com/cloud-native-toolkit/terraform-util-sealed-secret-cert) (>= 0.0.0)

## Example usage

```hcl
module "openshift-cicd" {
  source = "github.com/cloud-native-toolkit/terraform-tools-openshift-cicd"

  cluster_config_file = module.cluster.config_file_path
  cluster_type = module.cluster.platform.type_code
  gitops_namespace = module.openshift-gitops.name
  ingress_subdomain = module.cluster.platform.ingress
  olm_namespace = module.olm.olm_namespace
  operator_namespace = module.olm.target_namespace
  sealed_secret_cert = module.sealed-secret-cert.cert
  sealed_secret_namespace = module.sealed-secret.name
  sealed_secret_private_key = module.sealed-secret-cert.private_key
}

```

## Module details

### Inputs

| Name | Description | Required | Default | Source |
|------|-------------|---------|----------|--------|
| cluster_config_file | Cluster config file for Kubernetes cluster. | true |  | cluster.config_file_path |
| cluster_type | The type of cluster (openshift or kubernetes) | true |  | cluster.platform.type_code |
| olm_namespace | Namespace where olm is installed | true |  | olm.olm_namespace |
| operator_namespace | Namespace where operators will be installed | true |  | olm.target_namespace |
| gitops_namespace | Namespace where OpenShift GitOps will be installed | false | openshift-gitops | gitops_namespace.name |
| ingress_subdomain | The subdomain for ingresses in the cluster | true |  | cluster.platform.ingress |
| sealed_secret_cert | The certificate that will be used to encrypt sealed secrets. If not provided, a new one will be generated | true |  | cert.cert |
| sealed_secret_private_key | The private key that will be used to decrypt sealed secrets. If not provided, a new one will be generated | true |  | cert.private_key |
| sealed_secret_namespace | The namespace where the sealed secret will be deployed | false | sealed-secrets | sealed_secret_namespace.name |

### Outputs

| Name | Description |
|------|-------------|
| argocd_namespace | The namespace where the ArgoCD instance has been provisioned |
| argocd_service_account | The namespace where the ArgoCD instance has been provisioned |
| argocd_host | The ingress host for the Argo CD instance |
| argocd_url | The ingress url for the Argo CD instance |
| argocd_username | The username of the default ArgoCD admin user |
| argocd_password | The password of the default ArgoCD admin user |
| sealed_secrets_private_key |  |
| sealed_secrets_cert |  |
| sealed_secrets_namespace |  |
| tekton_namespace |  |

## Resources

- [Documentation](https://operate.cloudnativetoolkit.dev)
- [Module catalog](https://modules.cloudnativetoolkit.dev)

> License: Apache License 2.0 | Generated by iascable (3.0.1)
