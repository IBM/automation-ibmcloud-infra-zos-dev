# IBM KMS Key module

Module to lookup or create a KMS key


## Software dependencies

The module depends on the following software components:

### Terraform version

- \>= v0.15

### Terraform providers


- ibm (ibm-cloud/ibm)

### Module dependencies


- kms - one of:
    - [github.com/cloud-native-toolkit/terraform-ibm-key-protect](https://github.com/cloud-native-toolkit/terraform-ibm-key-protect) (>= 1.0.0)
    - [github.com/cloud-native-toolkit/terraform-ibm-hpcs](https://github.com/cloud-native-toolkit/terraform-ibm-hpcs) (>= 1.0.0)
    - [github.com/cloud-native-toolkit/terraform-ibm-kms](https://github.com/cloud-native-toolkit/terraform-ibm-kms) (>= 0.0.0)

## Example usage

```hcl
module "kms-key" {
  source = "github.com/terraform-ibm-modules/terraform-ibm-toolkit-kms-key"

  dual_auth_delete = var.kms-key_dual_auth_delete
  force_delete = var.kms-key_force_delete
  kms_id = module.kms.guid
  kms_private_url = module.kms.private_url
  kms_public_url = module.kms.public_url
  label = var.kms-key_label
  name = var.kms-key_name
  name_prefix = var.name_prefix
  provision = var.kms-key_provision
  provision_key_rotation_policy = var.kms-key_provision_key_rotation_policy
  rotation_interval = var.kms-key_rotation_interval
}

```

## Module details

### Inputs

| Name | Description | Required | Default | Source |
|------|-------------|---------|----------|--------|
| provision | Flag indicating that the key should be provisioned. If false then an existing key will be looked up | true |  |  |
| provision_key_rotation_policy | Flag indicating that the key rotation policy should be provisioned. If false then a rotation policy will not be created. | true |  |  |
| kms_id | The id of the kms instance. Required if kms_enabled is true | true |  | kms.guid |
| kms_public_url | The public url of the kms instance. Required if kms_enabled is true | true |  | kms.public_url |
| kms_private_url | The private url of the kms instance. Required if kms_enabled is true | true |  | kms.private_url |
| name | The name of the root key in the kms instance. Required if kms_enabled is true | true |  |  |
| name_prefix | The name_prefix used to build the name if one is not provided. If used the name will be `{name_prefix}-{label}` | false | base |  |
| label | The label used to build the name if one is not provided. If used the name will be `{name_prefix}-{label}` | false | key |  |
| rotation_interval | The interval in months that a root key needs to be rotated. | false | 3 |  |
| dual_auth_delete | Flag indicating that the key requires dual authorization to be deleted. | true |  |  |
| force_delete | Flag indicating that 'force' should be applied to key on delete | false | true |  |

### Outputs

| Name | Description |
|------|-------------|
| id | The id of the key |
| name | The crn of the key |
| crn | The crn of the key |
| kms_id | The id of the kms instance |
| kms_public_url | The public url of the kms instance |
| kms_private_url | The private url of the kms instance |

## Resources

- [Documentation](https://operate.cloudnativetoolkit.dev)
- [Module catalog](https://modules.cloudnativetoolkit.dev)

> License: Apache License 2.0 | Generated by iascable (3.2.0)
