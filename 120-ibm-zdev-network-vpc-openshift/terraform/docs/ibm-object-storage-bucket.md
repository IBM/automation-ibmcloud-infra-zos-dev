# IBM Object Storage Bucket module

Module to provision a Cloud Object Storage bucket


## Software dependencies

The module depends on the following software components:

### Terraform version

- \>= v0.15

### Terraform providers


None

### Module dependencies


- resource_group - [github.com/cloud-native-toolkit/terraform-ibm-resource-group](https://github.com/cloud-native-toolkit/terraform-ibm-resource-group) (>= 1.0.0)
- cos - [github.com/cloud-native-toolkit/terraform-ibm-object-storage](https://github.com/cloud-native-toolkit/terraform-ibm-object-storage) (>= 1.0.0)
- kms_key - [github.com/cloud-native-toolkit/terraform-ibm-kms-key](https://github.com/cloud-native-toolkit/terraform-ibm-kms-key) (>= 1.0.0)
- activity_tracker - [github.com/cloud-native-toolkit/terraform-ibm-activity-tracker](https://github.com/cloud-native-toolkit/terraform-ibm-activity-tracker) (>= 1.0.0)
- metrics_monitoring - [github.com/cloud-native-toolkit/terraform-ibm-sysdig](https://github.com/cloud-native-toolkit/terraform-ibm-sysdig) (>= 1.0.0)
- vpc - [github.com/cloud-native-toolkit/terraform-ibm-vpc](https://github.com/cloud-native-toolkit/terraform-ibm-vpc) (>= 1.11.1)

## Example usage

```hcl
module "flow_log_bucket" {
  source = "github.com/terraform-ibm-modules/terraform-ibm-toolkit-object-storage-bucket"

  activity_tracker_crn = module.ibm-activity-tracker.crn
  allowed_ip = var.flow_log_bucket_allowed_ip == null ? null : jsondecode(var.flow_log_bucket_allowed_ip)
  cos_instance_id = module.cos.id
  cos_key_id = module.cos.key_id
  cross_region_location = var.flow_log_bucket_cross_region_location
  enable_object_versioning = var.flow_log_bucket_enable_object_versioning
  ibmcloud_api_key = var.ibmcloud_api_key
  kms_key_crn = module.kms-key.crn
  label = var.flow_log_bucket_label
  metrics_monitoring_crn = var.flow_log_bucket_metrics_monitoring_crn
  name = var.flow_log_bucket_name
  name_prefix = var.name_prefix
  provision = var.flow_log_bucket_provision
  region = var.region
  resource_group_name = module.resource_group.name
  storage_class = var.flow_log_bucket_storage_class
  suffix = var.suffix
  vpc_ip_addresses = module.ibm-vpc.addresses
}

```

## Module details

### Inputs

| Name | Description | Required | Default | Source |
|------|-------------|---------|----------|--------|
| resource_group_name | The name of the IBM Cloud resource group where the VPC instance will be created. | true |  | resource_group.name |
| provision | Flag indicating that the instance should be provisioned. If false then an existing instance will be looked up | false | true |  |
| cos_instance_id | id of the COS instance | true |  | cos.id |
| name_prefix | The name of the cos resource | true |  |  |
| name | Name of the bucket | true |  |  |
| label | Label used to build the bucket name of not provided. | false | bucket |  |
| region | Bucket region | true |  |  |
| cross_region_location | The cross-region location of the bucket. This value is optional. Valid values are (us, eu, and ap). This value takes precedence over others if provided. | true |  |  |
| storage_class | Storage class of the bucket. Supported values are standard, vault, cold, flex, smart. | false | standard |  |
| ibmcloud_api_key | The IBM Cloud api token | true |  |  |
| kms_key_crn | The crn of the root key in the KMS | false | null | kms_key.crn |
| activity_tracker_crn | The crn of the Activity Tracking instance | false | null | activity_tracker.crn |
| metrics_monitoring_crn | The crn of the Metrics Monitoring instance | false | null | metrics_monitoring.crn |
| allowed_ip | A list of IPv4 or IPv6 addresses in CIDR notation that you want to allow access to your IBM Cloud Object Storage bucket. | true |  |  |
| vpc_ip_addresses | The list of ip addresses in the VPC that should be allowed to access the bucket. | true |  | vpc.addresses |
| cos_key_id | The id of the key provisioned for the COS instance | true |  | cos.key_id |
| enable_object_versioning | Object Versioning allows the COS user to keep multiple versions of an object in a bucket to protect against accidental deletion or overwrites. (Default = false) | true |  |  |
| suffix | Value added to the generated name to ensure it is unique | true |  |  |

### Outputs

| Name | Description |
|------|-------------|
| bucket_name | The name of the COS bucket instance |
| id | The ID of the COS bucket instance |
| crn | The CRN of the COS bucket instance |

## Resources

- [Documentation](https://operate.cloudnativetoolkit.dev)
- [Module catalog](https://modules.cloudnativetoolkit.dev)

> License: Apache License 2.0 | Generated by iascable (3.0.1)
